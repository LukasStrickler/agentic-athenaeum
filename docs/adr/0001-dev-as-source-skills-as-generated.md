# ADR 0001: dev/ as source of truth, skills/ as generated output

## Status

Accepted.

## Context

The repository distributes installable agent skills. Authors need to work in TypeScript with shared packages; end users receive self-contained JavaScript bundles. We need a clear split between what contributors edit and what the release process produces, so that:

- Review diffs stay focused on source logic, not bundled output.
- Generated runtime files do not cause merge conflicts.
- Releases are reproducible from source at a tagged version.

## Decision

- **`dev/`** is the only editable source: skill definitions (`SKILL.dev.md`), TypeScript action scripts (`scripts/*.ts`), references, and assets. Shared logic lives in `packages/contracts` and `packages/queries`.
- **`skills/`** is generated by `scripts/build-skills.mjs`: it copies non-TypeScript files, renames `SKILL.dev.md` to `SKILL.md`, and bundles each `scripts/*.ts` into `scripts/*.js` with esbuild (including inlined workspace packages).
- Normal contributor PRs must not modify `skills/`. Only release automation (branch `automation/release-generated-v*`) may update `skills/`. Local pre-commit and CI (`protect-generated-skills.yml`) enforce this.

## Consequences

- Contributors run `pnpm run verify` (typecheck, lint, format check, build) and commit only source changes.
- Release workflow runs build and opens a dedicated PR with `skills/**` changes; after merge, publish creates tag and release assets from the same source.
- Anyone can reproduce the contents of `skills/` at a given tag by checking out that tag and running `pnpm run build:skills`.
